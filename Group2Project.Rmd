---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

Group Members:
Andrew Shooman
Xiangyu Zeng
Thao Nguyen
Yunzhou Liu
   
```{r, warning=FALSE, message=FALSE}
library(readr)
library(mosaic)
houses = read_csv("AmesTrain2.csv")
```

Exclude all the categorical variables from this dataset.
```{r}
quantitative.house <- houses[c(2:4, 7:10, 17:19, 23:30, 32:33, 35:36, 39:42)]
head(quantitative.house)
```

## Part 1. Create an initial basic model

*build a model using Backward elimination, Forward selection, and Stepwise selection*

##### Build a model
```{r}
plot(quantitative.house$Price~., data=quantitative.house[c(2:26)])
```

```{r}
Full = lm(quantitative.house$Price~., data=quantitative.house[c(2:26)])
MSE=(summary(Full)$sigma)^2
backward.elimination = step(Full,scale=MSE, trace=FALSE)
summary(backward.elimination)
```

```{r}
none = lm(quantitative.house$Price~1, data=quantitative.house[2:26])
forward.selection = step(none, scope=list(upper=Full), scale=MSE, direction="forward", trace=FALSE)
summary(forward.selection)
```

```{r}
stepwise.selection = step(none, scope=list(upper=Full), scale=MSE, trace=FALSE)
summary(stepwise.selection)
```



## Part 2. Residual Analysis for basic model

*Based off model from backward selection*

The residuals show a significant curved relationship in the fitted plot, indicicating that the prediction is different based off of the price of the house, violating one of the linear model conditions. Also, the normal Q-Q plot has some extreme values at the ends, further showing that the residuals are not constant throughout the model.

```{r}
basic.model <- houses[c(2:4, 7:10, 16:17, 23:24,30, 33, 36, 41:42)]
basic.lm = lm(basic.model$Price~., data=basic.model[c(2:16)])
summary(basic.lm)
plot(basic.lm)
```

The maximum and minimum residual values of the model also have significantly large standardized and studentized values, which indicates both have sizeable influence on the model.

```{r}
range(basic.lm$residuals)
which.max(basic.lm$residuals)
which.min(basic.lm$residuals)
rstandard(basic.lm)[198]
rstudent(basic.lm)[198]
rstandard(basic.lm)[188]
rstudent(basic.lm)[188]
```


## Part 3. "Fancier model"


## Part 4. Residual Analysis for fancier model


## Part 5. Final Model
